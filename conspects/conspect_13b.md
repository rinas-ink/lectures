# 13b
## 01-function-objects
### 01-compare
Можно переопределпить оператор круглые скобки, получим функциональный объект.
`sort(v/vegin, v.end, Greater(*))` 
Эти круглые скобки не оператор, а создание объекта.
`Greater().operator()(4,5);`  
`Greater()(4,5)`   
### 02-compare-capture
- У класса с переопределенным методом мб поля.
`sort(,,Greater{3})`
- `Greater{3}` - Создаст объект даже если нет конструктора. Обычные скобки так не сделают. 
### 03, 04
- `set<int, CloserTo{3}> v{1,2,3,4}`	
- При копировании скопируется и компаратор.
- `vec.assign({1,2,3})` - присваивает 123 вектору.
### 05
`set<int, bool(*)(int,int)> v({1,2,3}, compare_gt);`
### 06-std-funtion
- `std::function<bool(int, int)> cmp = CloserTo()` - Всегда 32 байта, если передаем маленький функтор, хранит внутри себя, иначе на куче.
### 07-stl-copies
- Чтобы получить измененный функтор то:
```с++
Counter c;
s=std::for_each(v.begin(), v.end(), c)`
```
![](.conspect15_nov_images/1.png)

### 08-ref-wrapper
![](.conspect15_nov_images/9d7b2448.png)
- Нужен, т.к в for_each нельзя передать ссылку, а только указатель. 
## 02-lambdas
### 01
- Лямбда может захватывать только статические переменные класса. 
- При таком `[=]` захвате захватываются только те объекты, которые лямбда использует.
![](.conspect15_nov_images/fa198b45.png)
- Лямбда по умолчанию всегда константна, чтобы не была такой, то `mutable`.  
![](.conspect15_nov_images/3894c569.png)
- Захваченные по ссылке все равно менять можем, т.к мы запретили менять то, куда ссылается, но обращаться по ней не запретили.
![](.conspect15_nov_images/048702e9.png)
- Захватит весь *this (this - указатель, нужно разыменовать).
![](.conspect15_nov_images/d6a8f6d0.png)
- Можно проинициализировать в лямбде. Или по константной ссылке. 
![](.conspect15_nov_images/59d1c138.png)
### 02-recurcion
- Нельзя рекурсию.
![](.conspect15_nov_images/e9fb0f95.png)
- Можно так, но вызов виртуальной ф-ции(в functiion они есть) это долго.
![](.conspect15_nov_images/ec04d18f.png)
### 03
- Для каждой лямбды генерируется собственный класс. Это не скомпилируется.
![](.conspect15_nov_images/f44f5ae0.png)
- Есть обзорная лекция Егора по этому всему.
## 03-overload-delete
- Говорим, что есть функция, но нельзя вызывать. (Компилятор не выбирает перегрузку от инта, но и падает при вызове от добла).
![](.conspect15_nov_images/a2191571.png)
## 04-linkage
![](.conspect15_nov_images/aacd76dc.png)
![](.conspect15_nov_images/8814a7ec.png)
- `inline` - у этой переменной несколько переменных, они точно одинаковы, выбери одно.
### Виды
- internal - в текущей ед. транстляции. (в т.ч у глобальных).
- external - визно в других единицах
- no-lincage - в текущих фигурных.

## 05-static-deinitialization
- Можем уже убить вектор (вышли из мэйна) , когда вызываем деструктор.
![](.conspect15_nov_images/5011f486.png)
- Как бороться? Никогда не удалять. Unique_ptr тоже нельзя, т.к у него тоже нужно деструктор вызвать.  
![](.conspect15_nov_images/56d8d870.png)

## 06-typedef-using
![](.conspect15_nov_images/a6982535.png)
## 07-eval-orded
- Нет гарантии в каком порядке вычислятся аргументы функции. 
![](.conspect15_nov_images/23cfda9a.png)
- `, &&` - специальные операторы. Порядок работает если не перегрузить.
- До 17 стандарта здесь UB. Во время пушбека может менять адрес вектора.
![](.conspect15_nov_images/58b0fe67.png)
- Фигурные скобки заставляют вычислять слева направо.  
![](.conspect15_nov_images/cf126c92.png)
## 08-auto
![](.conspect15_nov_images/16c8f2de.png)
- Auto отбрасывает ссылки и константы. В него все копируется, если не написать & дополнительно.
## 09-invalidation
- Ссылки и итераторы могут умирать или нет.
![](.conspect15_nov_images/da71541a.png)
